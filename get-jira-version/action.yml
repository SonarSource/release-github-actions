name: Get Jira Version

description: Get jira version from the release version.

outputs:
  JIRA_VERSION:
    description: 'The Jira version derived from the release version.'
    value: ${{ steps.get_version.outputs.JIRA_VERSION }}

runs:
    using: "composite"
    steps:
      - uses: SonarSource/release-github-actions/get-release-version@add_get-release-version_action
        if: ${{ !env.RELEASE_VERSION }}
      - name: Get jira version from release version
        id: get_version
        shell: bash
        run: |
          # Extract everything up to the third dot (major.minor.patch)
          VERSION=$(echo "$RELEASE_VERSION" | cut -d '.' -f 1-3)
          
          # Remove trailing '.0' if it exists (to match Jira version format)
          JIRA_VERSION=$(echo "$VERSION" | sed 's/\.0$//')

          echo "JIRA_VERSION: ${JIRA_VERSION}"
          echo "JIRA_VERSION=${JIRA_VERSION}" >> "$GITHUB_ENV"
          echo "JIRA_VERSION=${JIRA_VERSION}" >> "$GITHUB_OUTPUT"
